import { FlexContainer } from './components/flex-container';
import { FlexItemFixed } from './components/flex-items-fixed';

# よくある問題と解決法

Flexboxを使用していると遭遇しがちな問題とその解決方法を、実例とともに解説します。
これらの問題を理解することで、より効果的にFlexboxを活用できるようになります。

## 問題1: テキストがはみ出る・溢れる

### 問題の発生例

フレックスアイテム内の長いテキストが親要素からはみ出してしまう場合があります。

{ 
  <div style={{ display: 'flex', width: '400px', border: '2px solid #ff0000', marginBottom: '20px', color: "black" }}>
    <div style={{
      flex: 1,
      padding: '10px',
      backgroundColor: '#f0f0f0',
      whiteSpace: 'nowrap'
    }}>
      このテキストは非常に長く、コンテナからはみ出してしまう可能性があります
    </div>
    <div style={{
      flex: 1,
      padding: '10px',
      backgroundColor: '#e0e0e0'
    }}>
      短いテキスト
    </div>
  </div>
}

### なぜこの問題が起こるのか？

**Flexboxの縮小アルゴリズムとテキストレンダリングの競合**

この問題は、以下の複合的な要因により発生します。

1. **フレックスアイテムのデフォルト最小サイズ**
   - `min-width` は `auto` がデフォルト
   - `min-width: auto` は、アイテムの「intrinsic minimum width」（内在する最小幅）を意味する
   - テキストの場合、これは最も長い単語の幅、または `white-space: nowrap` の場合はテキスト全体の幅

2. **ブラウザのテキストレンダリングエンジンの動作**
   - テキストは通常、単語境界で改行される（`overflow-wrap: normal` がデフォルト）
   - `white-space: nowrap` が設定されている場合、改行が禁止される
   - この場合、テキストの幅がコンテナを超えても、ブラウザは改行せずに描画を続ける

3. **Flexboxの空間分配アルゴリズム**
   - Flexboxは「available space」（利用可能な空間）を各アイテムに分配
   - しかし、アイテムの最小サイズ制約により、実際には指定された割合通りにならない場合がある
   - 特に `flex: 1` の場合でも、`min-width: auto` により縮小できる幅が制限される

### 解決法1: min-width: 0 を設定

`min-width: 0` を設定することで、フレックスアイテムの暗黙的最小サイズ制約が解除され、テキストがコンテナの幅に合わせて縮小可能になります。

```css title="CSS"
.flex-item {
  min-width: 0; /* 縮小を許可 */
  overflow: hidden;
  text-overflow: ellipsis;
}
```

{
  <div style={{ display: 'flex', width: '400px', border: '2px solid #00aa00', marginBottom: '20px', color: "black" }}>
    <div style={{
      flex: 1,
      minWidth: 0,
      padding: '10px',
      backgroundColor: '#f0f0f0',
      whiteSpace: 'nowrap',
      overflow: 'hidden',
      textOverflow: 'ellipsis'
    }}>
      このテキストは非常に長く、コンテナからはみ出してしまう可能性があります
    </div>
    <div style={{
      flex: 1,
      padding: '10px',
      backgroundColor: '#e0e0e0'
    }}>
      短いテキスト
    </div>
  </div>
}

### 解決法2: 改行を許可

強制的な改行を許可することで、テキストがコンテナ内に収まるようにします。

```css title="CSS"
.flex-item {
  overflow-wrap: break-word;
}
```

{
  <div style={{ display: 'flex', width: '400px', border: '2px solid #0066cc', marginBottom: '20px', color: "black" }}>
    <div style={{
      flex: 1,
      padding: '10px',
      backgroundColor: '#f0f0f0',
      overflowWrap: 'break-word'
    }}>
      このテキストは非常に長く、コンテナからはみ出してしまう可能性がありますが、改行されます
    </div>
    <div style={{
      flex: 1,
      padding: '10px',
      backgroundColor: '#e0e0e0'
    }}>
      短いテキスト
    </div>
  </div>
}

:::info
文章の折り返しの制御は複雑なので、[文章の折り返し指定のCSS最新版 - ICS MEDIA](https://ics.media/entry/240411/)を読むのがおすすめです。
:::