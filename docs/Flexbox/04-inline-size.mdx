import { FlexContainer } from './components/flex-container';
import { FlexItem } from './components/flex-items';
import { FlexItemFixed } from './components/flex-items-fixed';

# フレックスアイテムのサイズ

フレックスアイテムのサイズは、`flex-grow`、`flex-shrink`、`flex-basis` の3つのプロパティによって決まります。

## flex-basis

**flex-basis** は、フレックスアイテムの初期サイズ（ベースサイズ）を指定するプロパティです。
このプロパティは、flex-growやflex-shrinkが適用される前の、アイテムの理想的なサイズを定義します。

```css title="CSS"
.flex-item {
  flex-basis: 200px; /* 初期サイズを200pxに設定 */
}
```

### flex-basis の値

- `auto`（デフォルト）: アイテムのコンテンツサイズに基づく
- `<length>`（px, em, remなど）: 具体的な長さを指定
- `<percentage>`（%）: コンテナのサイズに対する割合
- `content`: コンテンツのサイズに基づく

### flex-basis の例

#### auto（デフォルト）

コンテンツのサイズに基づいてサイズが決まります。

<FlexContainer>
    <FlexItemFixed style={{ flexBasis: 'auto', flexGrow: 0, flexShrink: 0 }}>短いテキスト</FlexItemFixed>
    <FlexItemFixed style={{ flexBasis: 'auto', flexGrow: 0, flexShrink: 0 }}>これは長いテキストコンテンツです</FlexItemFixed>
    <FlexItemFixed style={{ flexBasis: 'auto', flexGrow: 0, flexShrink: 0 }}>中程度</FlexItemFixed>
</FlexContainer>

#### 固定サイズ

具体的なサイズを指定した場合：

<FlexContainer>
    <FlexItemFixed style={{ flexBasis: '100px', flexGrow: 0, flexShrink: 0 }}>100px</FlexItemFixed>
    <FlexItemFixed style={{ flexBasis: '200px', flexGrow: 0, flexShrink: 0 }}>200px</FlexItemFixed>
    <FlexItemFixed style={{ flexBasis: '150px', flexGrow: 0, flexShrink: 0 }}>150px</FlexItemFixed>
</FlexContainer>

## flex-grow

**flex-grow** は、フレックスコンテナに余剰スペースがある場合に、アイテムがどれくらい拡大するかを指定するプロパティです。
値が大きいほど、より多くの余剰スペースを占有します。

```css title="CSS"
.flex-item {
  flex-grow: 1; /* 他のアイテムと同じ比率で拡大 */
}
```

### flex-grow の値

- `0`（デフォルト）: 拡大しない
- `<number>`（正の数）: 拡大の比率を指定

### flex-grow の例

#### すべて同じ値

すべてのアイテムに `flex-grow: 1` を設定すると、等しく拡大します。

<FlexContainer>
    <FlexItemFixed style={{ flexGrow: 1, flexBasis: '50px' }}>flex-grow: 1</FlexItemFixed>
    <FlexItemFixed style={{ flexGrow: 1, flexBasis: '50px' }}>flex-grow: 1</FlexItemFixed>
    <FlexItemFixed style={{ flexGrow: 1, flexBasis: '50px' }}>flex-grow: 1</FlexItemFixed>
</FlexContainer>

#### 異なる値

異なる `flex-grow` 値を設定すると、比率に応じて拡大します。

<FlexContainer>
    <FlexItemFixed style={{ flexGrow: 1, flexBasis: '50px' }}>flex-grow: 1</FlexItemFixed>
    <FlexItemFixed style={{ flexGrow: 2, flexBasis: '50px' }}>flex-grow: 2</FlexItemFixed>
    <FlexItemFixed style={{ flexGrow: 1, flexBasis: '50px' }}>flex-grow: 1</FlexItemFixed>
</FlexContainer>

#### 拡大しない要素

`flex-grow: 0` のアイテムは拡大せず、他のアイテムが余剰スペースを占有します。

<FlexContainer>
    <FlexItemFixed style={{ flexGrow: 0, flexBasis: '100px' }}>flex-grow: 0</FlexItemFixed>
    <FlexItemFixed style={{ flexGrow: 1, flexBasis: '50px' }}>flex-grow: 1</FlexItemFixed>
    <FlexItemFixed style={{ flexGrow: 1, flexBasis: '50px' }}>flex-grow: 1</FlexItemFixed>
</FlexContainer>

## flex-shrink

**flex-shrink** は、フレックスコンテナのスペースが不足している場合に、アイテムがどれくらい縮小するかを指定するプロパティです。
値が大きいほど、より多く縮小されます。

```css title="CSS"
.flex-item {
  flex-shrink: 1; /* 他のアイテムと同じ比率で縮小 */
}
```

### flex-shrink の値

- `1`（デフォルト）: 縮小可能
- `0`: 縮小しない
- `<number>`（正の数）: 縮小の比率を指定

### flex-shrink の例

#### 縮小可能（デフォルト）

コンテナが狭い場合、アイテムは縮小されます。

<FlexContainer style={{ width: '300px' }}>
    <FlexItemFixed style={{ flexShrink: 1, flexBasis: '150px' }}>flex-shrink: 1</FlexItemFixed>
    <FlexItemFixed style={{ flexShrink: 1, flexBasis: '150px' }}>flex-shrink: 1</FlexItemFixed>
    <FlexItemFixed style={{ flexShrink: 1, flexBasis: '150px' }}>flex-shrink: 1</FlexItemFixed>
</FlexContainer>

#### 縮小しない要素

`flex-shrink: 0` のアイテムは縮小せず、固定サイズを保ちます。

<FlexContainer style={{ width: '300px' }}>
    <FlexItemFixed style={{ flexShrink: 0, flexBasis: '120px' }}>flex-shrink: 0</FlexItemFixed>
    <FlexItemFixed style={{ flexShrink: 1, flexBasis: '120px' }}>flex-shrink: 1</FlexItemFixed>
    <FlexItemFixed style={{ flexShrink: 1, flexBasis: '120px' }}>flex-shrink: 1</FlexItemFixed>
</FlexContainer>

#### 異なる縮小率

異なる `flex-shrink` 値を設定すると、比率に応じて縮小します。

<FlexContainer style={{ width: '300px' }}>
    <FlexItemFixed style={{ flexShrink: 1, flexBasis: '150px' }}>flex-shrink: 1</FlexItemFixed>
    <FlexItemFixed style={{ flexShrink: 3, flexBasis: '150px' }}>flex-shrink: 3</FlexItemFixed>
    <FlexItemFixed style={{ flexShrink: 1, flexBasis: '150px' }}>flex-shrink: 1</FlexItemFixed>
</FlexContainer>

## flex ショートハンド

`flex` プロパティは、`flex-grow`、`flex-shrink`、`flex-basis` をまとめて指定できるショートハンドプロパティです。

```css title="CSS"
.flex-item {
  flex: 1 1 200px; /* flex-grow: 1, flex-shrink: 1, flex-basis: 200px */
}
```

### よく使用される flex の値

#### flex: 1

`flex: 1` は `flex: 1 1 0%` の省略形で、等しく拡大・縮小するアイテムを作成します。

:::info 仕様とブラウザ実装の違い
実は、`flex: 1` の動作には仕様とブラウザ実装で微妙な違いがあります：

- **CSS仕様上**: `flex: 1` は `flex: 1 1 0` に展開されるべき
- **ブラウザ実装**: 多くのブラウザは `flex: 1 1 0%` として実装

この違いは、`flex-basis` の値が `0`（絶対値）か `0%`（パーセンテージ）かという重要な差を生み出します。現在のブラウザはより予測可能な動作のために `0%` を採用していますが、これが後述する「flex-basis: 0 と 0% の違い」につながっています。
:::

<FlexContainer>
    <FlexItemFixed style={{ flex: '1' }}>flex: 1</FlexItemFixed>
    <FlexItemFixed style={{ flex: '1' }}>flex: 1</FlexItemFixed>
    <FlexItemFixed style={{ flex: '1' }}>flex: 1</FlexItemFixed>
</FlexContainer>

#### flex: auto

`flex: auto` は `flex: 1 1 auto` の省略形で、コンテンツサイズを基準に拡大・縮小します。

<FlexContainer>
    <FlexItemFixed style={{ flex: 'auto' }}>短い</FlexItemFixed>
    <FlexItemFixed style={{ flex: 'auto' }}>これは長いコンテンツです</FlexItemFixed>
    <FlexItemFixed style={{ flex: 'auto' }}>中程度</FlexItemFixed>
</FlexContainer>

#### flex: none

`flex: none` は `flex: 0 0 auto` の省略形で、拡大も縮小もしません。

<FlexContainer>
    <FlexItemFixed style={{ flex: 'none' }}>flex: none</FlexItemFixed>
    <FlexItemFixed style={{ flex: '1' }}>flex: 1</FlexItemFixed>
    <FlexItemFixed style={{ flex: '1' }}>flex: 1</FlexItemFixed>
</FlexContainer>

## flex-basis: 0 と 0% の違い

前述した通り、CSS仕様では `flex: 1` は `flex: 1 1 0` に展開されるべきですが、多くのブラウザは `flex: 1 1 0%` として実装しています。では、`flex-basis: 0` と `flex-basis: 0%` は実際に何が違うのでしょうか？

多くの開発者が見落としがちな重要な違いがあります。見た目は似ていますが、内部的な計算方法が異なり、特定の状況で異なる結果を生み出すことがあります。

### 技術的な違い

**flex-basis: 0**
- 絶対値として常に0ピクセル
- コンテナのサイズに関係なく常に0
- アイテムは完全に縮小され、flex-growによる拡大のみに依存

**flex-basis: 0%**
- パーセンテージ値としてコンテナサイズの0%を計算
- コンテナのサイズが確定している場合は0ピクセルと同じ結果
- コンテナのサイズが不確定な場合は `content` サイズにフォールバック

### 通常のケース（確定したコンテナサイズ）

コンテナのサイズが確定している場合、両者の動作は同じです：

<div style={{ marginBottom: '20px' }}>
<h4>flex-basis: 0 を使用</h4>
<FlexContainer style={{ width: '400px' }}>
    <FlexItemFixed style={{ flexBasis: '0', flexGrow: 1 }}>flex-basis: 0</FlexItemFixed>
    <FlexItemFixed style={{ flexBasis: '0', flexGrow: 2 }}>flex-basis: 0 (grow: 2)</FlexItemFixed>
    <FlexItemFixed style={{ flexBasis: '0', flexGrow: 1 }}>flex-basis: 0</FlexItemFixed>
</FlexContainer>

<h4>flex-basis: 0% を使用</h4>
<FlexContainer style={{ width: '400px' }}>
    <FlexItemFixed style={{ flexBasis: '0%', flexGrow: 1 }}>flex-basis: 0%</FlexItemFixed>
    <FlexItemFixed style={{ flexBasis: '0%', flexGrow: 2 }}>flex-basis: 0% (grow: 2)</FlexItemFixed>
    <FlexItemFixed style={{ flexBasis: '0%', flexGrow: 1 }}>flex-basis: 0%</FlexItemFixed>
</FlexContainer>
</div>

### なぜブラウザは 0% を採用するのか

ブラウザが仕様と異なり `0%` を採用する理由は、より予測可能で一貫した動作を提供するためです：

```css title="CSS"
/* ブラウザ実装: flex: 1 のショートハンドは実際には以下と同等 */
.flex-item {
  flex-grow: 1;
  flex-shrink: 1;
  flex-basis: 0%; /* ブラウザは 0% を使用 */
}

/* CSS仕様: 本来は以下であるべき */
.flex-item-spec {
  flex-grow: 1;
  flex-shrink: 1;
  flex-basis: 0; /* 仕様では 0 */
}
```

この実装の違いは、特にコンテナのサイズが不確定な場合に影響を与える可能性があります。

### 推奨される使い方

異なるブラウザやコンテキストでの一貫した動作を保証するため：

**推奨事項:**
- `flex: 1`, `flex: 2` などのショートハンドを使用
- 直接 `flex-basis` を指定する場合は `0%` を使用
- 古いブラウザ対応が必要な場合は十分なテストを実施

```css title="CSS"
/* 良い例 */
.equal-width-items {
  flex: 1; /* 標準的で予測可能 */
}

/* 避けるべき例 */
.manual-specification {
  flex-basis: 0;  /* 予期しない動作の可能性 */
  flex-grow: 1;
}
```

この違いを理解することで、より堅牢で予測可能なFlexboxレイアウトを作成できます。

## 実用例

### カードレイアウト

異なるサイズのカードを含むレスポンシブなレイアウト：

```css title="CSS"
.card-container {
  display: flex;
  gap: 20px;
}

.card {
  flex: 1;
  min-width: 200px;
}

.card.featured {
  flex: 2; /* プレミアムプランは2倍の幅 */
}
```

<FlexContainer style={{ gap: '20px' }}>
    <div style={{
      flex: '1',
      minWidth: '200px',
      padding: '20px',
      backgroundColor: '#fff',
      border: '1px solid #ddd',
      borderRadius: '8px',
      boxShadow: '0 2px 4px rgba(0,0,0,0.1)'
    }}>
      <h3 style={{ margin: '0 0 10px 0', fontSize: '18px' }}>基本プラン</h3>
      <p style={{ margin: 0, color: '#666' }}>月額 ¥1,000</p>
    </div>
    <div style={{
      flex: '2',
      minWidth: '200px',
      padding: '20px',
      backgroundColor: '#e3f2fd',
      border: '2px solid #2196f3',
      borderRadius: '8px',
      boxShadow: '0 2px 4px rgba(0,0,0,0.1)'
    }}>
      <h3 style={{ margin: '0 0 10px 0', fontSize: '18px' }}>プレミアムプラン</h3>
      <p style={{ margin: 0, color: '#666' }}>月額 ¥2,000（推奨）</p>
    </div>
    <div style={{
      flex: '1',
      minWidth: '200px',
      padding: '20px',
      backgroundColor: '#fff',
      border: '1px solid #ddd',
      borderRadius: '8px',
      boxShadow: '0 2px 4px rgba(0,0,0,0.1)'
    }}>
      <h3 style={{ margin: '0 0 10px 0', fontSize: '18px' }}>エンタープライズ</h3>
      <p style={{ margin: 0, color: '#666' }}>要お問い合わせ</p>
    </div>
</FlexContainer>

### サイドバーレイアウト

固定幅のサイドバーと可変幅のメインコンテンツ：

```css title="CSS"
.layout-container {
  display: flex;
}

.sidebar {
  flex: 0 0 200px; /* 固定幅200px、拡大・縮小しない */
}

.main-content {
  flex: 1; /* 残りのスペースを占有 */
}
```

<FlexContainer style={{ height: '200px', alignItems: 'stretch' }}>
    <div style={{
      flex: '0 0 200px',
        padding: '20px',
      color: 'black',
      backgroundColor: '#f5f5f5',
      border: '1px solid #ddd',
      borderRadius: '8px 0 0 8px'
    }}>
      <strong>サイドバー</strong><br />
      （固定幅: 200px）
    </div>
    <div style={{
      flex: '1',
        padding: '20px',
      color: 'black',
      backgroundColor: '#fff',
      border: '1px solid #ddd',
      borderLeft: 'none',
      borderRadius: '0 8px 8px 0'
    }}>
      <strong>メインコンテンツ</strong><br />
      （可変幅: 残りのスペースを占有）
    </div>
</FlexContainer>

これらのプロパティを組み合わせることで、様々なレイアウトパターンを実現できます。
特に、レスポンシブデザインにおいて、画面サイズに応じて柔軟に調整されるレイアウトの作成に威力を発揮します。